<!DOCTYPE html>
<html lang="en" class="h-100">
<head>
	
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
	<title>Welcome to eCraft2Learn</title>
	
	<script src="libraries/js/jquery-3.2.1.min.js"></script>
	
	<link rel="stylesheet" href="libraries/css/bootstrap.min.css">
<!-- 	https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7 -->
    <script src="libraries/js/bootstrap.min.js"></script>  


    <!--<link href="libraries/css/metro.css" rel="stylesheet">
	<link href="libraries/css/metro-schemes.css" rel="stylesheet">
	<link href="libraries/css/metro-icons.css" rel="stylesheet">-->
	<link rel="stylesheet" href="libraries/css/metro-all.css">
    <script src="libraries/js/metro.js"></script>
	<script src="js/save-data.js"></script>
<!-- Sentry will report bugs to us -->
<!--     <script src="https://cdn.ravenjs.com/3.22.1/raven.min.js" crossorigin="anonymous"></script> -->
    <script>
	$(document).on('keypress', '.input input', function(e){
		if(e.which == 13) //Disable refresh on enterkey at login form
			e.preventDefault();
	});
	$(document).on('mouseout', '#bottomCharm', function(){
		if($('#bottomCharm button').length == 0) {
			$(this).data('charms').close();
		}
	});
	$(document).ready(function(){
		$('.project.bg-darkCobalt').removeClass('bg-darkCobalt');
		var userId = window.sessionStorage.getItem("userId")
		window.sessionStorage.setItem("currentProjectId", -userId);
		
		window.sessionStorage.removeItem("projectFiles");
		$('#activeProj').text('none');
		if($(window).width() < 420)
			$('#bottomCharm').hide();
	});
	$(window).scroll(function(event){
		if($(window).width() > 420)
			return;
		if($('#bottomCharm button').length == 0)
			$('#bottomCharm').hide();
		else 
			$('#bottomCharm').show();
	});
    if (navigator.onLine) {
    	// if offline no need to even try to load sentry
    	let script = document.createElement('script');
    	script.src = "https://cdn.ravenjs.com/3.22.1/raven.min.js";
    	script.crossorigin = "anonymous";
    	document.head.appendChild(script);
    	script.addEventListener('load',
    	                        function () {
									Raven.config('https://7780e314f7d64cc88db0fab885c9ca9b@sentry.io/305194',
											     {whitelistUrls: [/ecraft2learn\.github\.io/]})
										 .install();	                        	
    	                        });
    }  
    </script>

    <link rel="icon" type="image/png" href="images/eCraft2Learn-Favicon.png" />
	
		
	<!-- This links to the css file that we use for coloring of the tiles. The themes are stored in the "themes" folder. Change this to see other themes-->
	<link rel="stylesheet" type="text/css" href="themes/theme-3.css" />
	<link rel="stylesheet" type="text/css" href="extra-btn.css" />
	
	<script src="js/window-management.js"></script>
	<script src="js/helper-functions.js"></script>

	<script src="js/file_manager.js"></script>
	


	<!--LNU CODE START-->
	<script src="lnu/commenting/js/feedback-window-managment.js"></script>
	<!--LNU CODE END-->

	<style>
		.bg-darkBlue {
			background-color: #16499a !important;
		}
		#oerSearch {
			color: white;
		}
		#oerSearch::placeholder {
			color: white;
			opacity: 1; /* Firefox */
		}

		#oerSearch:-ms-input-placeholder { /* Internet Explorer 10-11 */
		   color: white;
		}

		#oerSearch::-ms-input-placeholder { /* Microsoft Edge */
		   color: white;
		}
		.large-button {
			height: 2.55rem;
			font-size: 1.05rem;
			line-height: 2.55rem;
		}
		.sub-header {
			font: 500 1.125rem/1.1 "Segoe UI", "Open Sans", sans-serif, serif;
			font-weight: normal;
		}
		.text-light {
			font-size: 2.25rem;
		}
		.no-scroll {
			overflow: hidden;
		}
		.scroll {
			overflow: auto;
		}
		.button.large {
			height: 1.25rem !important;
			line-height: 0px !important;
		}
		.branding-bar {
			font-weight: normal !important;
		}
		.charm-closer:after {
		  content: '\D7';
		  position: absolute;
		  left: 50%;
		  top: 50%;
		  margin-top: -0.65rem;
		  margin-left: -0.35rem;
		}
		.charm-closer:hover {
		  color: #ffffff;
		}
		.charm-closer:active {
		  color: #ffffff;
		}
		.charm-closer {
			position: absolute;
			display: block;
			padding: .5rem;
			text-align: center;
			vertical-align: middle;
			font-size: 2rem;
			font-weight: normal;
			z-index: 3;
			outline: none;
			cursor: pointer;
			color: #777777;
			top: .25rem;
			right: 1rem;
		}

		.toast {
			bottom: 4rem;
			font-size: 110%;
		}
		.whitelink {
			color: white !important;
		}
		.badge-medium-top {
			top: 1px;
			right: 1px;
			position: absolute;
			display: block;
			padding: 1px 1px;
			font-size: 14px;
			text-align: center;
			background-color: rgba(29,29,29,.1);
			z-index: 2;
			font-style: bold;
		}
		.badge-small-top {
			top: 2px;
			right: 2px;
			position: absolute;
			display: block;
			padding: 4px 4px;
			font-size: 12px;
			text-align: center;
			background-color: rgba(29,29,29,.1);
			z-index: 2;
		}
		.text-extra2-small {
			font-weight: 400;
			font-size: .50rem;
		}	
		.text-extra-small {
			font-weight: 400;
			font-size: .60rem;
		}	
		.v-menu {
			background-color: transparent;
			color: white;
		}
	
		.dropdown-toggle::before {
			border-color: #fff !important;
		}
		
        .tile-area-controls {
            position: fixed;
            right: 40px;
            top: 40px;
        }

        .tile-group {
            margin-left: 0;
			margin-top: 50px;
        }

        .tile, .tile-small, .tile-sqaure, .tile-wide, .tile-large, .tile-big, .tile-super {
            opacity: 0;
            -webkit-transform: scale(.8);
            transform: scale(.8);
        }

        #charmSettings .button {
            margin: 5px;
        }
		
		@media all and (min-width: 420px) {
			.tiles-group {
				margin-left: 40px;
			}
			.tile-area {
				overflow-x: scroll;
			}
			
			.button.large {
				font-size: 1.25rem;
			}
			.mobile-only {
				display: none;
			}
		}
		@media all and (min-width: 840px) {
			.window-content {
				overflow: hidden;
			}
		}

        @media screen and (max-width: 840px) {
            .tile-area {
                overflow-y: scroll;
            }
            .tile-area-controls {
                display: none;
            }
			.tiles-group {
				margin-bottom: 40px;
			}
			
			.small-text-mobile {
				font-size: 0.65rem;
			}
			
			.button.large {
				font-size: 0.65rem;
			}
			.window-content {
				-webkit-overflow-scrolling: touch;
				overflow: auto;
			}
        }

        @media screen and (max-width: 420px) {
            .tile-area {
                overflow-y: scroll;
            }

            .tile-area-controls {
                display: none;
            }
			
			.large-text {
				font-size: 0.8rem !important;
			}
			#eCraftMotto {
				font-size: 0.8rem;
			}
        }
		
		.login-form {
			width: 30rem;
			height: 20rem;
			background-color: #404436;

			position: absolute;
			top:0;
			bottom: 0;
			left: 0;
			right: 0;
			opacity: 0;

			margin: auto;
		}
    </style>
	
	<script>
	params={};location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(s,k,v){params[k]=v})
	
	$(function(){
            //$.StartScreen();

            var tiles = $(".tile, .tile-small, .tile-sqaure, .tile-wide, .tile-large, .tile-big, .tile-super");

            $.each(tiles, function(){
                var tile = $(this);
                setTimeout(function(){
                    tile.css({
                        opacity: 1,
                        "-webkit-transform": "scale(1)",
                        "transform": "scale(1)",
                        "-webkit-transition": ".3s",
                        "transition": ".3s"
                    });
                }, Math.floor(Math.random()*500));
            });

            $(".tile-group").animate({
                left: 0
            });
        });
		
	$(function(){
		//if(params['username']!="" && params['pilotsite']!="" && params['username']!=undefined && params['pilotsite']!=undefined){
		if ( window.sessionStorage.getItem("username")!=undefined 
		  		&& window.sessionStorage.getItem("pilotsite")!=undefined
		  		&& window.sessionStorage.getItem("userId")!=undefined
		  		&& window.sessionStorage.getItem("userId")!=-1)
		{
			$("#loginForm").hide();
			if (!navigator.onLine) {
				return;
			}
			(() => {

        			var sessionId = window.sessionStorage.getItem("pilotsite");// params['pilotsite'];

        			if (! sessionId)
                			return;

        			$.ajax({

                			type: 'POST',
                			data: 'sessionId=' + sessionId,
                			url: 'https://cs.uef.fi/~tapanit/ecraft2learn/api/pilot_2/get_materials.php',
                			success: (data) => {
									//alert(data);
                        			var urls = JSON.parse(data);

                        			var str = '';
									//<a href="#" data-role="searchable" onclick="showInOERWindow(event, './help/oer/3d_printing_troubleshooting_guide/3d_printing_troubleshooting_guide.pdf')">Other 3D Printing Problems</a>
                        			for (let i = 0; i < urls.length; i++) {

                                			//str += '<li><a target=\'_blank\' href=\'' + urls[i].url + '\'>' + urls[i].name + '</a></li>';
											str += '<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, \'' + urls[i].url + '\')">' + urls[i].name + '</a></li>';
                        			}

						if (str !== '')
                        				$('#teacher-material').html(str);

                			},
                			error: (error) => {

                			}
        			});

			})();


			//alert(hashFnv32a(params['username']));
		}
		else{
			$("#userProgressDiv").hide();
			$("#loginForm").animate({opacity:1},1000);
		}
	});
	</script>
	
	<script>
		window.addEventListener('message', function (e) {
			console.log(e.data);
			if(e.data === 'drawing') {
				$('body').css('overflow', 'hidden');
				$('html').css('overflow', 'hidden');
				$('body').css('overscroll-behavior', 'none');
			} else if(e.data === 'stopdrawing') {
				$('body').css('overflow', 'auto');
				$('html').css('overflow', 'auto');
				$('body').css('overscroll-behavior', 'auto');
			}
		});
		$(document).on('click', '#hidden_apps', function(){
			if($(this).is(':checked')) {
				$('.no-mobile').each(function(){
					$(this).show();
				});
				$('.tiles-grid').each(function(){
					$(this).show();
					if(!$(this).children().is(':visible')) {
						$(this).show();
					}
				});
			} else {
				$('.no-mobile').each(function(){
					$(this).hide();
				});
				$('.tiles-grid').each(function(){
					if(!$(this).children().is(':visible')) {
						$(this).hide();
					}
				});
			}
		});
		$(document).ready(function(){
			if(window.innerWidth < 420) { //mobile
				$('.no-mobile').each(function(){
					$(this).hide();
				});
			}
			$('.tiles-grid').each(function(){
				if(!$(this).children().is(':visible')) {
					$(this).hide();
				}
			});
		});
		$(document).on('mousedown touchstart touchmove', '.window-caption', function(e)
		{
			if(window.innerWidth < 640) {
				$('body').removeClass('scroll');
				$('body').addClass('no-scroll');
				$('body').css('overscroll-behavior', 'none');
			}
		});
		$(document).on('mouseup touchend', '.window-caption', function()
		{
			if(window.innerWidth < 640) {
				$('body').removeClass('no-scroll');
				$('body').addClass('scroll');
				$('body').css('overscroll-behavior', 'auto');
			}
		});
		$(document).on('click', '.btn-max', function(){
			window.scrollTo($(this).position.x, 0); 
			maximizeWindow($(this).closest('.window').find('.iframeWindow'));
			//$(this).closest('.window').find('.iframeWindow').css('height', '100%');
		});
		$(document).on('click', '.btn-min', function(){
			$(this).closest('.window').css('top', $(window).height() * 0.1 + $(window).scrollTop());
		});
		function infoClick(file, infoId) {
			if (file) {
				var username = window.sessionStorage.getItem("username");
				var analyticField = getAnalyticFieldName(infoId, true);
				sendAnalyticsData(hashFnv32a(username), 0, analyticField);
				/*make an HTTP request using the attribute value as the file name:*/
				xhttp = new XMLHttpRequest();
				xhttp.open("GET", file, true);
				xhttp.send();
				xhttp.onreadystatechange = function() {
					if (this.readyState == 4) {
						if (this.status == 200) { 
							Metro.infobox.create(this.responseText, "", {
								width: 600,
								removeOnClose: true
							});
						}
						if (this.status == 404) { Metro.infobox.create("Page not found.");}
					}
				}
			}
		}
		
		function helpClick(file, helpDialogId, event){
			if (file) {
				var username = window.sessionStorage.getItem("username");
				var analyticField = getAnalyticFieldName(helpDialogId, true);
				sendAnalyticsData(hashFnv32a(username), 0, analyticField);
				/*make an HTTP request using the attribute value as the file name:*/
				xhttp = new XMLHttpRequest();
				xhttp.open("GET", file, true);
				xhttp.send();
				xhttp.onreadystatechange = function() {
					if (this.readyState == 4) {
						if (this.status == 200) { 
							Metro.dialog.create({
								title: "", 
								content: this.responseText, 
								width: "600",
								removeOnClose: true,
								actions: [
									{
										caption: "Create",
										cls: "js-dialog-close button primary success",
										onclick: function(){
											$('.new_project_form').submit();
											//createNewProject();
										}
									},
									{
										caption: "Cancle",
										cls: "js-dialog-close"
									}
									
								]
							});
						}
						if (this.status == 404) { 
							Metro.notify.create(
								'Page not found.',
								'Alert',
								{
									cls: "alert"
								}
							);
						}
					}
				}
			}
		}
		
		function tileClick(toolUrl, winTitle, event){
			var analyticField;
		
			if(winTitle==undefined) {
				analyticField = getAnalyticFieldName(toolUrl);
				gotoTileDestination(toolUrl);

			}
			else{
				analyticField = getAnalyticFieldName(toolUrl);
				
				//var url = toolUrl + '&username=' + params['username'] + '&sessionId=' + params['pilotsite'];
				//console.log(url);
				
				//window.sessionStorage.setItem('username', params['username']);
				//window.sessionStorage.setItem('pilotsite', params['pilotsite']);
				
				openIframeWindow(toolUrl, winTitle, event);

			}

			var username = window.sessionStorage.getItem("username");
			sendAnalyticsData(hashFnv32a(username), 0, analyticField);
			//sendAnalyticsData(hashFnv32a($("username")), 0, analyticField);




		}
		
		function newProject(toolUrl, winTitle, event){
			openIframeWindowP(toolUrl, winTitle, event);
		}
		
		function showInOERWindow(event, addr){
			//allWin = $("div").find('[class], bg-red');
			allWin = $("*").find("div[data-role*='dialog']");
			oerWin = $("#oerWin");	
			
			var oerMainFolder = "help/oer/";
			var eventNode = $(event.srcElement);
			var oerText = $(eventNode).html();
			var oerAddress = addr==undefined ? (oerMainFolder + oerText + "/" + oerText + ".html").toLowerCase().replace(/ /g,'_') : addr.toLowerCase();

			if ($(oerWin).html() == undefined)
			{
				var dialog = openIframeWindow(oerAddress, "Open Educational Resources", event);
				$(dialog).attr('id', 'oerWin');
				/*var iframe = $(dialog).find("[id|='iframeWindow']")[0];
				var dcmnt = (iframe.contentDocument || iframe.contentWindow.document);
				var otherhead = dcmnt.getElementsByTagName("head")[0];
				var link = dcmnt.createElement("link");
				link.setAttribute("rel", "stylesheet");
				link.setAttribute("type", "text/css");
				link.setAttribute("href", "../../libraries/css/metro.css");
				otherhead.appendChild(link);
				
				alert(otherhead.innerHTML);
				curHead = document.getElementByTagName("head");
				//iframe = $(dialog).getElementById("iframeWindow");
				iframe.reload();
				alert(curHead);
				if($(iframe).find("head").length == 0)
					$(iframe).append("<head></head>");
				alert($(iframe).find("td").length);*/
			}
			else{
				var iframe = $(oerWin).find("[id|='iframeWindow']")[0];
				$(iframe).attr('src', oerAddress);
				
				var oerMinimizedBtn = $("#oerWin_btn");
				if($(oerMinimizedBtn).attr('id') == 'oerWin_btn'){
					unminimizeWindowFromJS(oerMinimizedBtn);
				}
			}
		}
	</script>
	
</head>

<body class="bg-dark fg-white h-100">

	<!-- Google Translate -->

	<!-- Conditionally activated if translate is in the hash term of the URL -- after the # -->
	<script>
	function googleTranslateElementInit() {
		 new google.translate.TranslateElement({pageLanguage: 'en',
												layout: google.translate.TranslateElement.InlineLayout.SIMPLE},
											   'google_translate_element');
	}
	if (window.location.hash.indexOf('translate') >= 0 && navigator.onLine) {
		var div = document.createElement('div');
		var add_div_and_script = function () {
			document.body.appendChild(div);
			var script = document.createElement('script');
			script.type = "text/javascript";
			script.src = "https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit";
			document.body.appendChild(script);
		}
		div.id = "google_translate_element";
		if (document.body) {
			add_div_and_script();
		} else {
			// wait for the document to load
			document.addEventListener('DOMContentLoaded', add_div_and_script);
		}
	}
	</script>
	
	<div class="container-fluid start-screen no-overflow mb-20">
		<div class="grid">
			<div class="row">
				<div class="cell-8"> 
				<!--pt-4 pl-4 pr-4 mb-0 -->
					<div class="pt-4 pl-4 pr-4 mb-0 img-container">
							<img id="eCraftLogo" style="min-width:120px;width:auto;" src="images/eCraft2Learn-icon.png" />
					</div>
					<div id="eCraftMotto" class="mt-0">
						Digital Fabrication and Maker Movement in Education <!--(<a href="./help/troubleshooting/" target="_blank">Trouble shooting help</a>)-->
					</div>
				</div>
				<div class="cell">
					<!-- User name and progress -->
					<div id="userProgressDiv" class="mt-4 mr-4 ml-4 mb-0" style="position: absolute; right:0; top:10px;">
						<div class="row">
							<div class="cell">
								<span class="icon mif-user fg-white mr-2 pl-0" style="float:right;"/><a id="userBadge" href="#" onclick="openUserMenu();" class="sub-header mt-0 ml-2 mr-0 mb-2 fg-darkBlue small-text-mobile" style="float:right;"><script>document.write(window.sessionStorage.getItem('username'));</script></span></a><br/>
							</div>
						</div>
						<div class="row">
							<div class="cell mt-0 pt-0" style="font-size: 0.8em;">
								<div class="place-right mr-2 fg-darkBlue" style="margin-top: -0.5em;">Project: <span id="activeProj"></span></div>
							</div>
						</div>
						<div class="row">
							<div class="cell">
								<div class="progress pull-right mr-2 mt-1 mb-1" data-role="progress" data-small="true" data-value="getUserProgress();" style="width:80%;"></div>
							</div>
						</div>
						<script>
							function openUserMenu(){
								$("#userMenu").show();
							}
							function getUserProgress(){
								var sessionId = window.sessionStorage.getItem('pilotsite');
								var users = window.sessionStorage.getItem('username');

								var formData = new FormData();
								formData.append("users", users);
								formData.append("sessionId", sessionId);

								$.ajax({
									url: 'http://cs.uef.fi/~tapanit/ecraft2learn/api/pilot_2/get_student_models_pilot_2.php',
									//url: 'http://localhost/fileman/fileman.php',
									dataType: 'text',
									cache: false,
									contentType: false,
									processData: false,
									data: formData,
									type: 'post',
									async: false,
									success: function (php_script_response) {
										//alert(php_script_response);
										return 50;
									}
								});
							}
						</script>
						<div class="row">
							<div class="cell">
								<div class="pull-right" onclick="$('#rightCharm').data('charms').open();">
									<button class="image-button large-button button fg-white bg-transparent large-text mt-0">Educational Resources</button>
								</div>
							</div>
						</div>
						<!--<div class="row">-->
							<!--<div class="cell">-->
								<!--<button class="image-button button fg-white bg-transparent large-text mt-0" onclick="openFeedbackWindow('./lnu/commenting/index.html');">-->
									<!--<span class="mif-pencil icon"></span>-->
									<!--<span class="caption">Commenting</span>-->
								<!--</button>-->
							<!--</div>-->
						<!--</div>-->



					</div>
					<div id="userMenu" class="m-2 p-4 bg-darkGray" style="position:absolute; right:0; top:0; display:none; z-index:1;">
						
						<div style="display:flex; justify-content: left; align-items: center; font-size:20px;"> <span class="icon mif-user mif-2x fg-lightTeal"></span> <span class="no-margin text-heavy"></span>&nbsp;<script>document.write(window.sessionStorage.getItem('username'));</script></span></div><br/>
						<div class="progress pull-right no-margin" data-role="progress" data-value="getUserProgress();" dataz-value="73" style="width:200px;"></div><br/><br/>
						<div class="mobile-only">
							<input id="hidden_apps" type="checkbox" data-role="checkbox" data-caption="Show hidden applications (mobile)">
							<br><br>
						</div>
						<button type="button" class="button primary" onclick="logUserOut();">Logout</button>
						<button type="button" class="button primary" onclick="$('#userMenu').hide();">Cancel</button>
						<script>
							function logUserOut(){
								window.sessionStorage.clear();
								location.reload();
							}
						</script>
					</div>
				</div>
			</div>
		</div>
		<div class="grid">
			<div class="row">
				<div class="cell">
					<!-- TILE AREA -->
					<div class="tiles-area pt-20 pl-10 pr-10">
						<!-- IDEATION GROUP -->
						<div class="tiles-grid tiles-group size-1 fg-white mb-15" data-group-title="Imagine">
							<!-- UEF Tools -->
							<!--UEF Ideation-->
							<div data-role="tile" class="tile bg-ideation fg-white" data-effect="hover-slide-up">
								<span class="mif-bubbles badge-medium-top pr-4 bg-transparent" onclick="openFeedbackWindow('./lnu/commenting/index.html','eCraft Search');"></span>
								<span class="mif-question badge-medium-top m-0 bg-transparent" onclick="infoClick('./about/ecraft-search-help.html', '#eCraftSearchDialog');"></span>
								<div class="slide-front" onclick="tileClick('./uef/search/index.html', 'eCraft Search', event);">
									<img class="icon" src="./images/google-drive-logo-flat.png">
									<span class="branding-bar">eCraft Search</span>
								</div>
								<div id="test" class="slide-back text-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('./uef/search/index.html', 'eCraft Search', event);">
									Use this to search for help from Maker web sites
								</div>
							</div>
							<div data-role="tile" class="tile bg-ideation fg-white no-mobile" data-effect="hover-slide-up">
								<span class="mif-bubbles badge-medium-top pr-4 bg-transparent" onclick="openFeedbackWindow('./lnu/commenting/index.html','Inspiratorium');"></span>
								<span class="mif-question badge-medium-top m-0 bg-transparent" onclick="infoClick('./about/inspiratorium-help.html', '#inspiratoriumDialog');"></span>
								<div class="slide-front" onclick="tileClick('http://ecraft.zsi.at/', undefined, event);">
									<img class="icon" src="./images/inspiratorium_logo.svg">
									<span class="branding-bar">Inspiratorium</span>
								</div>
								<div  class="slide-back text-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('http://ecraft.zsi.at/', undefined, event);">
									Let yourself inspire and discover amazing instructables via the association driven Inspiratorium
								</div>
							</div>
						</div> <!--End of group tiles-->
						<!-- PLAN GROUP -->
						<div class="tiles-grid tiles-group size-2 fg-white  mb-15" data-group-title="Plan">
							<!--UEF Ideation-->
							<div data-role="tile" class="tile bg-plan fg-white" data-effect="hover-slide-up">
								<span class="mif-bubbles badge-medium-top pr-4 bg-transparent" onclick="openFeedbackWindow('./lnu/commenting/index.html','eCraft Plan');"></span>
								<span class="mif-question badge-medium-top m-0 bg-transparent" onclick="infoClick('./about/ecraft-idea-help.html', '#eCraftIdeaDialog');"></span>
								<div class="slide-front" onclick="tileClick('./uef/ideation/index.html', 'eCraft Idea', event);">
									<img class="icon" src="./images/google-drive-logo-flat.png">
									<span class="branding-bar">eCraft Plan</span>
								</div>
								<div class="slide-back text-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('./uef/ideation/index.html', 'eCraft Idea', event);">
									Use this to note down your ideas
								</div>
							</div>
							<!-- eCraft TODO -->
							<div data-role="tile" data-size="medium" class="tile bg-plan fg-white" data-effect="hover-slide-up">
								<span class="mif-question badge-medium-top m-0 bg-transparent" onclick="infoClick('./about/ecraft-idea-help.html', '#eCraftIdeaDialog');"></span>
								<div class="slide-front" onclick="tileClick('./uef/plan/index.html', 'eCraft Todo', event);">
									<img class="icon" src="./images/google-drive-logo-flat.png">
									<span class="branding-bar">eCraft TODO</span>
								</div>
								<div class="slide-back text-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('./uef/plan/index.html', 'eCraft Todo', event);">
									Use this to plan tasks of the project
								</div>
							</div>							
							<!-- Trello -->
							<div data-role="tile" data-size="small" class="tile bg-plan fg-white no-mobile" data-effect="hover-slide-up">
								<span class="mif-bubbles badge-medium-top pr-4 bg-transparent" onclick="openFeedbackWindow('./lnu/commenting/index.html','Trello);"></span>
								<span class="mif-question badge-small-top m-0 p-0 bg-transparent" onclick="infoClick('./about/trello-help.html', '#TrelloDialog');"></span>
								<div class="slide-front" onclick="tileClick('https://trello.com/', undefined, event);">
									<img class="icon" width="50%" src="./images/trello-logo.png">
								</div>
								<div class="slide-back text-extra-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('https://trello.com/', undefined, event);">
									Trello helps you plan and work together
								</div>
							</div>
						</div> <!--End of group tiles-->
						<!-- CREATE GROUP -->
						<div class="tiles-grid tiles-group size-2 fg-white  mb-15" data-group-title="Create">
							<!-- TinkerCad 3D Design -->
							<div data-role="tile" class="tile bg-create fg-white no-mobile" data-effect="hover-slide-up">
								<span class="mif-bubbles badge-medium-top pr-4 bg-transparent" onclick="openFeedbackWindow('./lnu/commenting/index.html','TinkerCad 3D Design');"></span>
								<span class="mif-question badge-medium-top m-0 bg-transparent" onclick="infoClick('./about/tinkercad-3d-design-help.html', '#TinkerCad3DDesignDialog');"></span>
								<div class="slide-front" onclick="tileClick('https://www.tinkercad.com/#/?type=tinkercad&collection=designs', 'TinkerCad 3D Design', event);">
									<img class="icon" src="./images/tinkercad-logo.png">
									<span class="branding-bar">3D Design</span>
								</div>
								<div class="slide-back text-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('https://www.tinkercad.com/#/?type=tinkercad&collection=designs', 'TinkerCad 3D Design', event);">
									TinkerCad is a 3D modelling application
								</div>
							</div>
							<!-- TinkerCad Circuit Design -->
							<div data-role="tile" class="tile bg-create fg-white no-mobile" data-effect="hover-slide-up">
								<span class="mif-bubbles badge-medium-top pr-4 bg-transparent" onclick="openFeedbackWindow('./lnu/commenting/index.html','TinkerCad Circuits');"></span>
								<span class="mif-question badge-medium-top m-0 bg-transparent" onclick="infoClick('./about/tinkercad-circuit-design-help.html', '#TinkerCadCircuitDesignDialog');"></span>
								<div class="slide-front" onclick="tileClick('https://www.tinkercad.com/#/?type=circuits&collection=designs', 'TinkerCad Circuit Design', event);">
									<img class="icon" src="./images/tinkercad-logo.png">
									<span class="branding-bar">Circuit Design</span>
								</div>
								<div class="slide-back text-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('https://www.tinkercad.com/#/?type=circuits&collection=designs', 'TinkerCad Circuit Design', event);">
									TinkerCad includes a circuit design and simulation application
								</div>
							</div>
							<!-- Beetle Blocks -->
							<div data-role="tile" class="tile bg-create fg-white no-mobile" data-effect="hover-slide-up">
								<span class="mif-bubbles badge-medium-top pr-4 bg-transparent" onclick="openFeedbackWindow('./lnu/commenting/index.html','Beetle Blocks');"></span>
								<span class="mif-question badge-medium-top m-0 bg-transparent" onclick="infoClick('./about/beetleblocks-help.html', '#BeetleBloxDialog');"></span>
								<div class="slide-front" onclick="tileClick('http://beetleblocks.com/run/', undefined, event);">
									<img class="icon" src="./images/beetle-blocks.png">
									<span class="branding-bar">Beetle Blocks</span>
								</div>
								<div class="slide-back text-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('http://beetleblocks.com/', undefined, event);">
									Design a 3D model through programming
								</div>
							</div>
							<!-- 3D slincing -->
							<div data-role="tile" class="tile bg-create fg-white no-mobile" data-effect="hover-slide-up">
									<span class="mif-question badge-medium-top m-0 bg-transparent" onclick="tileClick('./uef/slice/index.html', 'Slicer', event);"></span>
									<div class="slide-front" onclick="tileClick('./uef/slice/index.html', 'Slicer', event);">
											<img class="icon" src="./images/slice.png">
											<span class="branding-bar">3D slicing</span>
									</div>       
									<div class="slide-back text-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('./uef/slice/index.html', 'Slicer', event);">
											Slice 3D modeles for 3D printer
									</div>       
							</div>	
							<!-- 3D Slah -->
							<div data-role="tile" data-size="small" class="tile bg-create fg-white no-mobile" data-effect="hover-slide-up">
								<span class="mif-bubbles badge-medium-top pr-4 bg-transparent" onclick="openFeedbackWindow('./lnu/commenting/index.html','3D Slash');"></span>
								<span class="mif-question badge-small-top m-0 p-0 bg-transparent" onclick="infoClick('./about/3d-slash-help.html', '#3DSlashDialog');"></span>
								<div class="slide-front" onclick="tileClick('https://www.3dslash.net/slash.php', '3D Slash', event);">
									<img class="icon" width="50%" src="./images/3d-slash-logo.png">
								</div>
								<div class="slide-back text-extra-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('https://www.3dslash.net/slash.php', '3D Slash', event);">
									3D Slash to make models
								</div>
							</div>
							<!-- Cura -->
							<div data-role="tile" data-size="small" class="tile bg-create fg-white no-mobile" data-effect="hover-slide-up">
								<span class="mif-bubbles badge-medium-top pr-4 bg-transparent" onclick="openFeedbackWindow('./lnu/commenting/index.html','Cura');"></span>
								<span class="mif-question badge-small-top m-0 p-0 bg-transparent" onclick="infoClick('./about/cura-help.html', '#CuraDialog');"></span>
								<div class="slide-front" onclick="infoClick('./about/cura-help.html', '#CuraDialog');">
									<img class="icon" width="50%" src="./images/cura-logo.png">
								</div>
								<div class="slide-back text-extra-small d-flex flex-justify-center flex-align-center p-3" onclick="infoClick('./about/cura-help.html', '#CuraDialog');">
									Cura to print 3D models
								</div>
							</div>
						</div> <!-- End of Create Group-->
						<!-- PROGRAM GROUP -->
						<div class="tiles-grid tiles-group size-2 fg-white  mb-15" data-group-title="Program">
							<!-- SNAP -->
							<div data-role="tile" class="tile bg-ardu-pi fg-white no-mobile" data-effect="hover-slide-up">
								<span class="mif-bubbles badge-medium-top pr-4 bg-transparent" onclick="openFeedbackWindow('./lnu/commenting/index.html','Snap!');"></span>
								<span class="mif-question badge-medium-top m-0 bg-transparent" onclick="infoClick('./about/snap-help.html', '#SnapDialog');"></span>
								<div class="slide-front" onclick="tileClick('./snap/snap.html','Snap!', event);">
									<img class="icon" src="./images/snap_logo-110.png">
									<span class="branding-bar">Snap!</span>
								</div>
								<div class="slide-back text-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('./snap/snap.html','Snap!', event);">
									<span><span class='notranslate' style="position:relative;" translate='no'>Snap!</span> might have been called Scratch Senior</span>
								</div>
							</div>
							<!-- SNAP4ARDUINO -->
							<div data-role="tile" class="tile bg-arduino fg-white no-mobile" data-effect="hover-slide-up">
								<span class="mif-bubbles badge-medium-top pr-4 bg-transparent" onclick="openFeedbackWindow('./lnu/commenting/index.html','Snap4Arduino');"></span>
								<span class="mif-question badge-medium-top m-0 bg-transparent" onclick="infoClick('./about/snap4arduino-help.html', '#Snap4ArduinoDialog');"></span>
								<div class="slide-front" onclick="tileClick('./snap4arduino/index.html','Snap4Arduino', event);">
									<img class="icon" src="./images/snap_logo-110.png">
									<span class="branding-bar">Snap4Arduino</span>
								</div>
								<div class="slide-back text-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('./snap4arduino/index.html','Snap4Arduino', event);">
									A version of Snap! for controlling Arduinos. Click the ? for help if this is the first time.
								</div>
							</div>
							<!-- ARDUBLOCK -->
							<div data-role="tile" data-size="small" class="tile bg-arduino fg-white no-mobile" data-effect="hover-slide-up">
								<span class="mif-bubbles badge-medium-top pr-4 bg-transparent" onclick="openFeedbackWindow('./lnu/commenting/index.html','Ardublock');"></span>
								<span class="mif-question badge-small-top m-0 p-0 bg-transparent" onclick="infoClick('./about/ardublock-help.html', '#ArdublockDialog');"></span>
								<div class="slide-front" onclick="infoClick('./about/cura-help.html', '#ArdublockDialog');">
									<span class="tile-image icon"><span class='notranslate' translate='no'>A</span></span>
								</div>
								<div class="slide-back text-extra2-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('http://blog.ardublock.com/', undefined, event);">
									Ardublock blocks-based language for programming Arduinos.
								</div>
							</div>
							<!-- SCRATCH 4 RPi -->
							<div data-role="tile" data-size="small" class="tile bg-raspberry fg-white no-mobile" data-effect="hover-slide-up">
								<span class="mif-bubbles badge-medium-top pr-4 bg-transparent" onclick="openFeedbackWindow('./lnu/commenting/index.html','Scratch for RPi');"></span>
								<span class="mif-question badge-small-top m-0 p-0 bg-transparent" onclick="infoClick('./about/scratch-4-raspberry-pi.html', '#Scratch4RPiDialog');"></span>
								<div class="slide-front" onclick="tileClick('https://scratch.mit.edu/', undefined, event);">
									<img class="icon" src="./images/scratch-logo-small.png">
								</div>
								<div class="slide-back text-extra-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('https://scratch.mit.edu/', undefined, event);">
									Scratch for Raspberry Pi.
								</div>
							</div>
							<!-- SCRATCH 4 ARDUINO -->
							<div data-role="tile" data-size="small" class="tile bg-arduino fg-white no-mobile" data-effect="hover-slide-up">
								<span class="mif-bubbles badge-medium-top pr-4 bg-transparent" onclick="openFeedbackWindow('./lnu/commenting/index.html','Scratch for Arduino');"></span>
								<span class="mif-question badge-small-top m-0 p-0 bg-transparent" onclick="infoClick('./about/scratch-4-arduino.html', '#Scratch4ArduDialog');"></span>
								<div class="slide-front" onclick="tileClick('http://s4a.cat/', undefined, event);">
									<img class="icon" src="./images/scratch-logo-small.png">
								</div>
								<div class="slide-back text-extra-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('http://s4a.cat/', undefined, event);">
									Scratch for Arduino.
								</div>
							</div>
							<!-- APP INVENTOR -->
							<div data-role="tile" data-size="small" class="tile bg-ardu-pi fg-white no-mobile" data-effect="hover-slide-up">
								<span class="mif-bubbles badge-medium-top pr-4 bg-transparent" onclick="openFeedbackWindow('./lnu/commenting/index.html','App Inventor');"></span>
								<span class="mif-question badge-small-top m-0 p-0 bg-transparent" onclick="infoClick('./about/app-inventor-help.html', '#AppInventorDialog');"></span>
								<div class="slide-front" onclick="tileClick('http://ai2.appinventor.mit.edu/', undefined, event);">
									<img class="icon" src="./images/app-inventor-allwhite.png">
								</div>
								<div class="slide-back text-extra-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('http://ai2.appinventor.mit.edu/', undefined, event);">
									MIT App Inventor
								</div>
							</div>
							<!-- POCKET CODE -->
							<div data-role="tile" data-size="small" class="tile bg-ardu-pi fg-white no-mobile" data-effect="hover-slide-up">
								<span class="mif-bubbles badge-medium-top pr-4 bg-transparent" onclick="openFeedbackWindow('./lnu/commenting/index.html','Pocket Code');"></span>
								<span class="mif-question badge-small-top m-0 p-0 bg-transparent" onclick="infoClick('./about/pocket-code-help.html', '#PocketCodeDialog');"></span>
								<div class="slide-front" onclick="tileClick('https://www.catrobat.org/intro/', undefined, event);">
									<img class="icon" src="./images/pocket-code-allwhite.png">
								</div>
								<div class="slide-back text-extra-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('https://www.catrobat.org/intro/', undefined, event);">
									<span class='notranslate' translate='no'>Pocket Code</span>
								</div>
							</div>
							<!-- NETSBLOX -->
							<div data-role="tile" data-size="small" class="tile bg-ardu-pi fg-white no-mobile" data-effect="hover-slide-up">
								<span class="mif-bubbles badge-medium-top pr-4 bg-transparent" onclick="openFeedbackWindow('./lnu/commenting/index.html','NetsBlox');"></span>
								<span class="mif-question badge-small-top m-0 p-0 bg-transparent" onclick="infoClick('./about/netsblox-help.html', '#NetsBloxDialog');"></span>
								<div class="slide-front" onclick="tileClick('https://editor.netsblox.org/','NetsBlox', event);">
									<img class="icon" src="./images/netsblox.png">
								</div>
								<div class="slide-back text-extra-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('https://editor.netsblox.org/','NetsBlox', event);">
									NetsBlox
								</div>
							</div>
							<!-- ARDUINO IDE -->
							<div data-role="tile" data-size="small" class="tile bg-arduino fg-white no-mobile" data-effect="hover-slide-up">
								<span class="mif-bubbles badge-medium-top pr-4 bg-transparent" onclick="openFeedbackWindow('./lnu/commenting/index.html','Arduino IDE');"></span>
								<span class="mif-question badge-small-top m-0 p-0 bg-transparent" onclick="infoClick('./about/arduino-ide-help.html', '#ArduinoIdeDialog');"></span>
								<div class="slide-front" onclick="tileClick('https://create.arduino.cc/editor', undefined, event);">
									<img class="icon" src="./images/arduino-ide.png">
								</div>
								<div class="slide-back text-extra-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('https://create.arduino.cc/editor', undefined, event);">
									Arduino IDE
								</div>
							</div>
							<!-- ARDUINOBOT -->
							<div data-role="tile" data-size="small" class="tile bg-arduino fg-white no-mobile" data-effect="hover-slide-up">
								<span class="mif-question badge-small-top m-0 p-0 bg-transparent" onclick="infoClick('./about/arduinobot-help.html', '#Arduinobot', event);"></span>
								<div class="slide-front" onclick="tileClick('./about/arduinobot-login.html', 'Arduinobot', event);">
									<img class="icon" src="./images/arduinobot-only.png">
								</div>
								<div class="slide-back text-extra-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('./about/arduinobot-login.html', 'Arduinobot', event);">
									Arduinobot
								</div>
							</div>
						</div> <!-- End of Program Group-->
						<!-- SHARE GROUP -->
						<div class="tiles-grid tiles-group size-1 fg-white  mb-15" data-group-title="Share">
							<!--Thingiverse-->
							<div data-role="tile" class="tile bg-share fg-white no-mobile" data-effect="hover-slide-up">
								<span class="mif-bubbles badge-medium-top pr-4 bg-transparent" onclick="openFeedbackWindow('./lnu/commenting/index.html','Thingiverse');"></span>
								<span class="mif-question badge-medium-top m-0 bg-transparent" onclick="infoClick('./about/thingiverse-help.html', '#ThingiverseDialog');"></span>
								<div class="slide-front" onclick="tileClick('https://www.thingiverse.com/','Thingiverse', event);">
									<img class="icon" src="./images/thingiverse-logo.png">
									<span class="branding-bar">Thingiverse</span>
								</div>
								<div class="slide-back text-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('https://www.thingiverse.com/','Thingiverse', event);">
									Share you 3D models here
								</div>
							</div>
							<!--My Work-->
							<div data-role="tile" class="tile bg-share fg-white" data-effect="hover-slide-up">
								<span class="mif-question badge-medium-top m-0 bg-transparent" onclick="infoClick('./about/share-my-work-help.html', '#ShareMyWorkDialog');"></span>
								<div class="slide-front" onclick="tileClick('./lnu/sharing/index.html','Sharing', event);">
									<img class="icon" src="./lnu/sharing/images/share-tool-icon.png">
									<span class="branding-bar">Share My Work</span>
								</div>
								<div class="slide-back text-small d-flex flex-justify-center flex-align-center p-3" onclick="tileClick('./lnu/sharing/index.html','Sharing', event);">
									Share you work here
								</div>
							</div>
						</div> <!--End of group tiles-->
					</div> <!--End of Main Tile Area-->
				</div>
			</div>
			<div class="row">
				<div class="cell">
					<div class="tiles-area pt-5 pl-10 pr-10" id="divProjects" stylez="display:none;">
						<div class="tiles-grid tiles-group size-1 fg-white  mb-15" data-group-title="UUI Tools">
							<!--<span class="tile-group-title">UUI Tools</span><br>-->
							<div id="#spanPrj_0" class="tile-large bg-darkBlue fg-white p-5 project-tile">
								<div class="grid">
									<div class="row">
										<div class="cell">
											<div class="" style="width:100%; height:100%;">
												<a href="#" class="whiteLink" onclick="infoClick('./dialogs/new_project.html', 'New project', event);">Create New Project ...</a><br/>
												<hr class="pb-0 mb-0">
											</div>
										</div>
									</div>
									<div class="row">
										<div class="cell pt-0 mt-0 mb-5">
											<span class="text-shadow">Recent Projects</span>
										</div>
									</div>
									<div class="row">
										<div class="cell"id="tileProjects">	
											<script>
												var userId = window.sessionStorage.getItem("userId");
												if(userId!=undefined && userId!=-1){
													getUserProjects(userId, handleGetProjectsResponse);
													$('.project-tile').data('PROJECTID',-userId);
												}
								
												function handleGetProjectsResponse(phpResponse){
													var jsonData = JSON.parse(phpResponse);
													
													for(i=0; i<jsonData.DATA.length && i<8;i++){
														var prjId = jsonData.DATA[i].ID;
														var spanLink = $("<div>").css("width","100%").css("border", "0px").addClass("project m-0 p-0").attr("id", "spanPrj_" + prjId);
														var alink = $("<a>").addClass("whiteLink").prop("href","#").data('PROJECTID',prjId).click(SelectProject).html(jsonData.DATA[i].PRJ_NAME);
														if(window.sessionStorage.getItem("currentProjectId")==prjId)
															spanLink.addClass("bg-darkCobalt");
														spanLink.append(alink);
														$("#tileProjects").append(spanLink);//.append("<br/>");
													}
												}
												function SelectProject(){
													var curPrjId = window.sessionStorage.getItem("currentProjectId");
													var curSelectedDiv = null;
													if(curPrjId!=null && curPrjId!=undefined && curPrjId!=-1)
														curSelectedDiv = $("#spanPrj_" + curPrjId);

													var clickedLink = $(event.srcElement);
													var prjId = clickedLink.data("PROJECTID");
													if(!prjId || prjId == 0)
														prjId = -userId
													window.sessionStorage.setItem("currentProjectId",prjId);
													if(prjId > 0)
														$('#activeProj').text(clickedLink.text());
													else 
														$('#activeProj').text('none');
													var newSelectedDiv = $("#spanPrj_" + prjId);
													if(curSelectedDiv!=null)
														curSelectedDiv.removeClass("bg-darkCobalt");
													if(newSelectedDiv!=null && newSelectedDiv!=undefined)
														newSelectedDiv.addClass("bg-darkCobalt");
													getProjectFiles(prjId);
												}
												$(document).on('click', '.project-tile', function(){
													SelectProject();
												});
											</script>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>		
	</div><!--End of Main Content Container-->
	
	<!--Login Box and Hidden Data-->
	<form  id="loginForm" class="login-form p-3 mx-auto border db-default win-shadow" style="z-index:2; height: 450px;" data-overlay="true">		
        <!--<form>-->
			<h1 class="text-light mt-4">Login to eCraft2Learn</h1>
			<hr class="thin"/>
			<div class="form-group">
				<label for="user_login">Username:</label>
				<input type="text" name="username" id="username" data-role="input" placeholder="Enter your name, nickname, or user name.">
			</div>
			<div class="form-group">
				<label for="user_password">Pilot Site:</label>
				<select class="fg-black" name="pilotsite" id="pilotsite">
					<option value='10'>Not at a pilot site</option>
					<option value='11'>Pataluoto School</option>
					<option value='12'>Lyseo High School</option>
					<option value='13'>Athens informal pilot site</option>
					<option value='14'>Athens formal pilot site</option>
				</select>
			</div>
			<p>Or</p>
			<div class='form-group'>
				<label for='manual-session'>Enter session id:</label>
				<input type='text' name='manual-session' id='manual-session'>
			</div>
            <div class="form-group">
                <button type="button" class="button primary" onclick="HandleUserLogin();">Login</button>
				<!--<button type="button" class="button link">Cancel</button>-->
				<script>
					function HandleUserLogin(){
						
						var sessionId = $('#manual-session').val();

						if (sessionId.trim() !== '') {
						
							$.ajax({

								type: 'GET',
								url: 'https://cs.uef.fi/~tapanit/ecraft2learn/api/pilot_2/check_session?sessionId=' + sessionId,
								success: (data) => {

									if (data === 'ok')
										selectUser($('#username').val(), sessionId, HandleLoginCallback);
									else
										alert('No session with session id ' + sessionId + ' exists.');
								

								},
								error: (error) => {

									alert('Error while processing the given session id. Please check your network connectivity');

								}

							});
	
							selectUser($('#username').val(), sessionId, HandleLoginCallback);
						
						} else
							selectUser($("#username").val(), $("#pilotsite").val(), HandleLoginCallback);
					}
					function HandleLoginCallback(phpResponse){
						handleSelectUserResponse(phpResponse);
						if(window.sessionStorage.getItem("errorStatus")=="fail"){
							//TODO: I am assuming that the new user IS a group user. Later we should ask the user and act accordingly
							addUser($("#username").val(), $("#pilotsite").val(), 1);
							location.reload();
						}
						else{
							location.reload();
						}
					}
					$('#loginForm').keyup(function HandleKeyUp(event)
					{
						if(event.which == 13)
							HandleUserLogin();
					});
					$('#pilotsite').keydown(function HandleKeyUp(event)
					{
						event.preventDefault();
						if(event.which == 13)
							HandleUserLogin();
					});
				</script>
            </div>
			<div class="overlay" style="background: rgba(0, 0, 0, 0.5); z-index:-1;"></div>
        <!--</form>-->
	</form>
	<!-- OER Panel to the Right-->
	<!--<div class="pull-right" style="position: absolute; right:0; top:80px; z-index:0;" onclick="$('#rightCharm').data('charms').open();">
		<button class="image-button button large fg-white bg-transparent large-text">Educational Resources</button>
    </div>-->
	<div id="rightCharm" data-role="charms" data-position="right"  class="bg-help-charm" style="overflow-y:auto;">
		<div class="pull-right" style="position: absolute; right:0; top:0;" onclick="$('#rightCharm').data('charms').close();">
			<button class="image-button large-button bg-transparent charm-closer"></button>
		</div>
		<br/><br/>
		<ul id="oerElementsUL" class="v-menu subdown darcula notranslate bg-transparent fg-white p-3" translate="no" style="width:100%;">
			<!--<li><a href="#"><img src="./images/electronics.png">Electronic Devices</a></li>-->

			<!-- Electronic Devices -->
			<li><a class="dropdown-toggle"><img src="./images/electronics.png" class="mif-ani-hover-spanner"></img>Electronic Devices</a>
				<ul class="v-menu" data-role="dropdown">
					<li class="divider"></li>
					<li><a href="#" class="dropdown-toggle">Basics</a>
						<ul class="v-menu" data-role="dropdown">
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/.html');"></a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/arduino/arduino.html');">Arduino</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/arduino_prototyping_shield/arduino_prototyping_shield.html');">Arduino Prototyping Shield</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/batteries/batteries.html');">Batteries</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/breadboard/breadboard.html');">Breadboard</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/DC_Motor/DC_Motor.html');">DC Motor</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Digital_and_Analog_Signals/Digital_and_Analog_Signals.html');">Digital and Analog Signals</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/general_purpose_transistor/general_purpose_transistor.html');">General Purpose Transistor</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Input_and_Output_Devices/Input_and_Output_Devices.html');">Input and Output Devices</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Jumper_Wires/Jumper_Wires.html');">Jumper Wires</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/led/led.html');">LED</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/raspberry_pi/raspberry_pi.html');">Raspberry Pi</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Resistor/Resistor.html');">Resistor</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Switch/Switch.html');">Switch</a></li>
						</ul>
					</li>
					<li><a href="#" class="dropdown-toggle">Sensors</a>
						<ul class="v-menu" data-role="dropdown">
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Accelerometer/Accelerometer.html');">Accelerometer</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Color_Sensor/Color_Sensor.html');">Color Sensor</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/flame_sensor/flame_sensor.html');">Flame Sensor</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Flex_Sensor/Flex_Sensor.html');">Flex Sensor</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/force_sensor/force_sensor.html');">Force Sensor</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Gas_Sensor/Gas_Sensor.html');">Gas Sensor</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Gyroscope/Gyroscope.html');">Gyroscope</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/imu/imu.html');">IMU</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/ir_proximity_sensor/ir_proximity_sensor.html');">IR Proximity Sensor</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/LDR_Sensor/LDR_Sensor.html');">Photoresistor (LDR Sensor)</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/line_tracking_sensor/line_tracking_sensor.html');">Line Tracking Sensor</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Microphone/Microphone.html');">Microphone</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Piezo_Sensor/Piezo_Sensor.html');">Piezo Sensor</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/PIR_sensor/PIR_sensor.html');">PIR sensor</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Potentiometer_Sensor/Potentiometer_Sensor.html');">Potentiometer Sensor</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Pressure_Sensor/Pressure_Sensor.html');">Pressure Sensor</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Sensors/Sensors.html');">Sensors</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Tilt_Sensor/Tilt_Sensor.html');">Tilt Sensor</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Ultrasonic_Sensor/Ultrasonic_Sensor.html');">Ultrasonic Sensor</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/visible_light_sensor/visible_light_sensor.html');">Visible Light Sensor</a></li>
						</ul>
					</li>
					<li><a href="#" class="dropdown-toggle">More ...</a>
						<ul class="v-menu" data-role="dropdown">
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/IR_Array/IR_Array.html');">IR Array</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Conductive_Paint/Conductive_Paint.html');">Conductive Paint</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Conductive_Thread/Conductive_Thread.html');">Conductive Thread</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Copper_Tape/Copper_Tape.html');">Copper Tape</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/l293d_h_bridge/l293d_h_bridge.html');">L293D Bridge</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Magnetic_Switch/Magnetic_Switch.html');">Magnetic Switch</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/motor_controller/motor_controller.html');">Motor Controller</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/piezo_speaker/piezo_speaker.html');">Piezo Speaker</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/relay_board/relay_board.html');">Relay Board</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/Servo_Motor/Servo_Motor.html');">Servo Motor</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/step_up_voltage_regulator/step_up_voltage_regulator.html');">Step-up Voltage Regulator</a></li>
						</ul>
					</li>
					<li class="divider"></li>
				</ul>
			</li>
			
			<!-- 3D Printing -->
			<li><a href="#" class="dropdown-toggle">
					<span class="icon mif-rocket mif-ani-hover-spanner"></span>
					<span class="title">3D Printing</span>
				</a>
				<ul class="v-menu" data-role="dropdown">
					<li class="divider"></li>
					<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/3d_printing/3d_printing.html');">3D Printing</a></li>
					<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/introduction_to_3d_printing/introduction_to_3d_printing.html');">3D Printing Introduction</a></li>
					<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/3d_cad_modelling_in_tinkercad/3d_cad_modelling_in_tinkercad.html');">3D Modelling in Tinkercad</a></li>
					<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/getting_started_guide_for_schools/getting_started_guide_for_schools.html');">Getting Started</a></li>
					<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/extruding_a_3d_model_from_a_2d_image/extruding_a_3d_model_from_a_2d_image.html');">3D Model from 2D Image</a></li>
					<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/cura_quick_start_guide/cura_quick_start_guide.pdf');">Cura Quickstart</a></li>
					<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/cura_videos_3/cura_videos_3.html');">Cura Videos</a></li>
					<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/ultimaker_2plus_manual/ultimaker_2plus_manual.html');">UM2+ User Manual</a></li>
					<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/ultimaker_3_quick_start_guide/ultimaker_3_quick_start_guide.html');">UM3 Quick Start</a></li>
					<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, 'help/oer/ultimaker_3_manual/ultimaker_3_manual.html');">UM3 Manual</a></li>
					<li class="divider"></li>
				</ul>
			</li>
				
			<!-- A.I. Section -->
			<li><a href="#" class="dropdown-toggle">
					<span class="icon mif-squirrel mif-ani-hover-spanner"></span>
					<span class="title">A.I.</span>
				</a>
				<ul class="v-menu" data-role="dropdown">
					<li class="divider"></li>
					<li><a href="#" data-role="searchable" onclick="tileClick('/ai/', 'AI programming guide in Snap and Snap4Arduino', event)">AI programming in Snap</a></li>
					<li class="divider"></li>
				</ul>
			</li>

			<!-- Communities Section -->
			<li><a href="#" class="dropdown-toggle">
					<span class="icon mif-users mif-ani-hover-spanner"></span>
					<span class="title">Communities</span>
				</a>
				<ul class="v-menu" data-role="dropdown">
					<li class="divider"></li>
					<li><a href="#" onclick="tileClick('https://community.ultimaker.com/','Ultimaker Community', event);">3D Printing</a></li>
					<!--The following 2 links cannot be opened in a window because of XFrame limitation and HTTP/HTTPS, for now I am opening them in a new tab, until the issue is fixed-->
					<li><a href="https://forum.arduino.cc/"  target="_blank" onclick_oldold="tileClick('https://forum.arduino.cc/','Arduino Forum', event);">Arduino Forum</a></li>
					<li><a href="http://playground.arduino.cc/" target="_blank" onclick_old="tileClick('http://playground.arduino.cc/','Arduino Playground', event);">Arduino Wiki</a></li>
					<!---->
					<li><a href="#" onclick="tileClick('https://www.createeducation.com/','Ultimaker Create Education', event);">ULTIMAKER Create Education</a></li>
					<li class="divider"></li>
				</ul>
			</li>
			
			<!-- Troubleshooting Section -->
			<li><a href="#" class="dropdown-toggle">
					<span class="icon mif-wrench mif-ani-hover-spanner"></span>
					<span class="title">Troubleshooting</span>
				</a>
				<ul class="v-menu" data-role="dropdown">
					<li class="divider"></li>
					<!--<li><a href="#" onclick="tileClick('https://ultimaker.com/en/resources/troubleshooting','Ultimaker Troubleshooting', event);">3D Printing</a></li>-->
					<li><a href="#" class="dropdown-toggle">3D Printing</a>
						<ul class="v-menu" data-role="dropdown">
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, './help/oer/3d_print_not_sticking_to_the_build_plate_long_version/3d_print_not_sticking_to_the_build_plate_long_version.html')">3D Print Not Sticking to Plate</a></li>
							<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, './help/oer/3d_printing_troubleshooting_guide/3d_printing_troubleshooting_guide.pdf')">Other 3D Printing Problems</a></li>
							<li class="divider"></li>
						</ul>
					</li>
					<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, './help/troubleshooting/index.html');">eCraft2Learn Components</a></li>
					<li class="divider"></li>
				</ul>
			</li>

			
			<!-- Worksheets Section -->
			<li><a href="#" class="dropdown-toggle">
					<span class="icon mif-stack mif-ani-hover-spanner"></span>
					<span class="title">Worksheets</span>
				</a>
				<ul class="v-menu" data-role="dropdown">
					<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, './help/oer/3d_modelling_student_worksheet/3d_modelling_student_worksheet.html')">3D Modelling</a></li>
					<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, './help/oer/ai_student_worksheet/ai_student_worksheet.html')">A.I. (Artificial Intelligence)</a></li>
					<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, './help/oer/christmas_student_worksheet/christmas_student_worksheet.html')">Christmas</a></li>
					<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, './help/oer/lighthouse_student_worksheet/lighthouse_student_worksheet.html')">Lighthouse</a></li>
					<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, './help/oer/open_robot_student_worksheet/open_robot_student_worksheet_1.html')">Open Robot 1</a></li>
					<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, './help/oer/open_robot_student_worksheet/open_robot_student_worksheet_2.html')">Open Robot 2</a></li>
					<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, './help/oer/open_robot_student_worksheet/open_robot_student_worksheet_3.html')">Open Robot 3</a></li>
					<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, './help/oer/shyrabbit_student_worksheet/shyrabbit_student_worksheet.html')">Shy Rabbit</a></li>
					<li><a href="#" data-role="searchable" onclick="showInOERWindow(event, './help/oer/sunflower_student_worksheet/sunflower_student_worksheet.html')">Sunflower</a></li>
					<li class="divider"></li>
				</ul>
			</li>

			<!-- Teacher Uploads Section-->
			<li><a href="#" class="dropdown-toggle">
				<span class="icon mif-organization mif-ani-hover-spanner"></span>
				<span class="title">Teacher Uploads</span>
				</a>
				<ul class="v-menu" data-role="dropdown" id="teacher-material">
					<li><a href="#">No material available . . . </a></li>
				</ul>
			</li>
		</ul>
		
		<br/>
		
		<div class="input-control text m-2" style="width: 250px; right:0;">
			<input class="fg-white" type="text" data-role="search" data-clear-button="false" id="oerSearch" placeholder="Search..." onkeyup="searchOER();" data-on-search-button-click="searchOER();">
			<!--<button class="button" onclick="searchOER();"><span class="mif-search"></span></button>-->
			<script>
				function searchOER(){
					var text2search = $("#oerSearch").val().toLowerCase();
					var elemsList = $("#oerElementsUL").find("li");//.find('[data-role], searchable');
					var resultsDiv = $("#oerResults");
					var aElem;
					var aText;

					$(resultsDiv).empty();
					if(text2search.length == 0)
						return;
					$.each(elemsList, function(i, liElem){
						aElem = $(liElem).children("a");
					
						if($(aElem).attr('data-role')=="searchable"){
							aElem.addClass('fg-darkBlue');
							aText = $(aElem).text();
							//alert(aText+", "+text2search);
							if(aText.toLowerCase().indexOf(text2search)>=0)
								$(resultsDiv).append($(aElem).clone().addClass('oerSearchResult')).append("<br>");
						}
					});

					
				}	
			</script>
		</div>

		<div id="oerResults" class="p-3" style="font-size: 0.875rem;">

		</div>
	</div>



	
	<!-- The Task Bar at the bottom of the page-->
	<div id="charmCatcher" style="height:20px; position:fixed; bottom:0%; width:100%; opacity:0; background-color:red; z-index:0;" onmouseenter="Metro.charms.open('#bottomCharm');"></div>
	<div id="bottomCharm" data-role="charms" data-position="bottom"  class="bg-darkBlue"><span>&nbsp;</span></div>

	<script>

	(() => {

		setInterval(() => {

			var user = window.sessionStorage.getItem('username');
			var sessionId = window.sessionStorage.getItem('pilotsite');

			var lastId = window.localStorage.getItem('lastMessageId');

			if (! lastId)
				lastId = 0;

			if (user && sessionId) {

				$.ajax({

					type: 'POST',
					url: 'https://cs.uef.fi/~tapanit/ecraft2learn/api/pilot_2/get_student_messages.php',
					data: 'user=' + user + '&sessionId=' + sessionId + '&lastId=' + lastId,
					success: (data) => {
						
						try {

							var messages = JSON.parse(data);
						
						} catch (e) {
						
							return;
							
						}
							
						if (Array.isArray(messages)) {

							var id = lastId;
							
							for (let i = 0; i < messages.length; i++) {
							
								id = messages[i].id;
								
								 Metro.dialog.create({
        								title: "Message from your teacher.",
        								content: "<div>" + messages[i].message + "</div>",
        								clsDialog: "bg-dark",
        								clsTitle: "fg-yellow",
        								clsContent: "fg-white",
        								clsDefaultAction: "alert"
    								});
								
											    
							}
							
							id++;
							
							window.localStorage.setItem('lastMessageId', id);

						}

					},
					error: (error) => { }

				});

			}

		}, 2000);

	})();
		
	</script>
		
</body>
